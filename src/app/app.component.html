<div class="app-container">
  <!-- Header -->
  <header class="app-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="app-title">
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
          </svg>
          Posts data Binding
        </h1>
        <p class="app-subtitle">{{ posts.length }} posts loaded</p>
      </div>

      <div class="header-actions">
        <button class="button button-secondary" (click)="openColumnChooser()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="4" y1="21" x2="4" y2="14"></line>
            <line x1="4" y1="10" x2="4" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="3"></line>
            <line x1="20" y1="21" x2="20" y2="16"></line>
            <line x1="20" y1="12" x2="20" y2="3"></line>
            <line x1="1" y1="14" x2="7" y2="14"></line>
            <line x1="9" y1="8" x2="15" y2="8"></line>
            <line x1="17" y1="16" x2="23" y2="16"></line>
          </svg>
          Columns
        </button>

        <button class="button button-secondary" (click)="previewSelectedColumns()"
          [disabled]="selectedColumns.length === 0">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
          Preview
        </button>

        <button class="button button-secondary" (click)="exportJSON()" [disabled]="selectedColumns.length === 0">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          Export
        </button>

        <button class="button button-primary" (click)="saveSelectedColumns()" [disabled]="!canSaveColumns"
          [class.loading]="savingColumns">
          <svg *ngIf="!savingColumns" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
            <polyline points="17 21 17 13 7 13 7 21"></polyline>
            <polyline points="7 3 7 8 15 8"></polyline>
          </svg>
          <div *ngIf="savingColumns" class="spinner-small"></div>
          <span>{{ savingColumns ? 'Saving...' : 'Save Selected' }}</span>
        </button>

        <button class="button button-accent" (click)="saveAllData()" [disabled]="!canSaveAll"
          [class.loading]="savingAll">
          <svg *ngIf="!savingAll" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          <div *ngIf="savingAll" class="spinner-small"></div>
          <span>{{ savingAll ? 'Saving...' : 'Save All' }}</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="app-main">
    <div class="spreadsheet-card">
      <app-spreadsheet [posts]="posts" [loading]="loading" [error]="error"></app-spreadsheet>
    </div>
  </main>

  <!-- Column Chooser -->
  <app-column-chooser [columns]="spreadsheet ? spreadsheet.columns : []" [isOpen]="columnChooserOpen"
    (close)="closeColumnChooser()" (columnToggled)="handleColumnToggled($event)"></app-column-chooser>

  <!-- Preview Modal -->
  <app-preview-modal [isOpen]="previewModalOpen" [payload]="previewPayload"
    (close)="closePreviewModal()"></app-preview-modal>

  <!-- Toast Notifications -->
  <app-toast [toasts]="toasts"></app-toast>
</div>